import{r as v,j as i}from"./index-Cf2K4EOO.js";import"./react-OvXVS5lI.js";const q="_agentSidebar_1brf4_1",L="_open_1brf4_17",E="_agentHeader_1brf4_21",R="_closeButton_1brf4_38",U="_agentContent_1brf4_59",B="_chatContainer_1brf4_67",K="_messages_1brf4_75",O="_message_1brf4_75",A="_userMessage_1brf4_94",D="_botMessage_1brf4_101",H="_messageText_1brf4_108",z="_messageTime_1brf4_112",W="_inputContainer_1brf4_118",V="_chatInput_1brf4_128",F="_sendButton_1brf4_144",u={agentSidebar:q,open:L,agentHeader:E,closeButton:R,agentContent:U,chatContainer:B,messages:K,message:O,userMessage:A,botMessage:D,messageText:H,messageTime:z,inputContainer:W,chatInput:V,sendButton:F},Y=/[a-z0-9]+/g,Q=new Set(["the","and","is","in","to","of","a","for","with","on","that","this","it","as","are","be","or"]);function I(s){return((s||"").toLowerCase().match(Y)||[]).filter(h=>!Q.has(h))}function G(s,c="doc",h=800,b=200){const g=[];let r=0;for(;r<s.length;){const m=s.slice(r,r+h),a=`${c}#${r}`;g.push({id:a,source:c,text:m.trim()}),r+=h-b}return g}function J(s){const c={},h={},b={};for(const a of s){const y=I(a.text);b[a.id]=y;const t={};for(const l of y)t[l]=(t[l]||0)+1;h[a.id]=t;const f=new Set;for(const l of Object.keys(t))f.has(l)||(c[l]=(c[l]||0)+1,f.add(l))}const g=s.length||1,r={};for(const a of Object.keys(c))r[a]=Math.log(1+g/c[a]);const m={};for(const a of s){const y=h[a.id]||{};let t=0;for(const[f,l]of Object.entries(y)){const w=(l||0)*(r[f]||0);t+=w*w}m[a.id]=Math.sqrt(t)||1}return{docs:s,idf:r,docTfs:h,docNorms:m}}function X(s,c,h=4){const b=I(c),g={};for(const t of b)g[t]=(g[t]||0)+1;const r={};for(const[t,f]of Object.entries(g))r[t]=f*(s.idf[t]||0);let m=0;for(const t of Object.values(r))m+=t*t;m=Math.sqrt(m)||1;const a=[];for(const t of s.docs){const f=s.docTfs[t.id]||{};let l=0;for(const[_,x]of Object.entries(r)){const T=(f[_]||0)*(s.idf[_]||0);l+=x*T}const w=(s.docNorms[t.id]||1)*m,C=w?l/w:0;a.push({id:t.id,score:C})}return a.sort((t,f)=>f.score-t.score),a.slice(0,h).map(t=>({...s.docs.find(l=>l.id===t.id),score:t.score}))}const te=({classifier:s,compare:c,speedScale:h,isOpen:b,onClose:g})=>{const[r,m]=v.useState([{id:1,text:"Hello! I'm your local ML Assistant. I can help you understand machine learning concepts, explain classifiers, and provide tips for using the visualizer. What would you like to know?",isUser:!1,timestamp:new Date}]),[a,y]=v.useState(""),t=v.useRef(null),[f,l]=v.useState(!1),[w,C]=v.useState(!1),[_]=v.useState(()=>`session_${Date.now()}_${Math.random().toString(36).substring(2,9)}`),x=()=>{try{const n=globalThis.process;return!!(n&&n.env&&n.env.NODE_ENV!=="production")}catch{return!1}};v.useEffect(()=>{(async()=>{try{const e=await fetch("/docs/assistant_context.md");if(!e.ok)throw new Error("no docs");const o=await e.text(),d=G(o,"assistant_context");t.current=J(d),l(!0)}catch(e){t.current=null,l(!1),x()&&console.debug("agentpanel: load index error",e)}})()},[]);const T=n=>({linear:{description:"A linear perceptron that finds a straight line to separate data points into two classes.",strengths:["Simple and fast","Works well with linearly separable data","Easy to understand"],weaknesses:["Cannot model curved/complex boundaries","Sensitive to outliers","Underfits non-linear patterns"],useCases:["Binary classification","Well-separated data","Educational purposes"]},poly:{description:"A polynomial perceptron that can learn curved decision boundaries using polynomial features.",strengths:["Can handle non-linear data","More flexible than linear","Still relatively simple"],weaknesses:["Feature explosion with high degrees","Prone to overfitting without regularization","Choice of degree is manual"],useCases:["Non-linear classification","Curved decision boundaries","Moderate complexity data"]},mlp:{description:"A Multi-Layer Perceptron (neural network) with configurable hidden layers and neurons.",strengths:["Very flexible","Can learn complex patterns","Modern deep learning approach"],weaknesses:["Needs tuning (layers, lr, epochs)","Slower to train","Less interpretable"],useCases:["Complex classification","Pattern recognition","Advanced ML demonstrations"]},knn:{description:"K-Nearest Neighbors algorithm that classifies points based on their closest neighbors.",strengths:["No training phase","Intuitive","Non-parametric"],weaknesses:["Prediction slows with many points","Sensitive to feature scaling & noise","Choice of K affects bias/variance"],useCases:["Instance-based learning","Small datasets","Understanding distance-based classification"]}})[n]||{description:"Unknown classifier",strengths:[],weaknesses:[],useCases:[]},j=n=>{const e=T(n),o=n.toUpperCase(),d=e.strengths.map(k=>`â€¢ ${k}`).join(`
`),p=e.weaknesses.map(k=>`â€¢ ${k}`).join(`
`),P=e.useCases.map(k=>`â€¢ ${k}`).join(`
`);return`**${o}**
${e.description}

Strengths:
${d}

Limitations:
${p}

Best for:
${P}`},M=n=>{const e=n.toLowerCase().trim();if(e.includes("equation")||e.includes("formula")||e.includes("boundary")){if(c)return"In Compare mode there are two classifiers at once, so I canâ€™t show a single equation. Turn off Compare to get the current classifierâ€™s equation.";try{const o=window.mlvStatus;if(s==="linear"||s==="poly")return o&&o.classifier===s&&o.equation?`Current ${s.toUpperCase()} decision boundary:
${o.equation}`:s==="linear"?"Iâ€™ll show the line equation once the model has trained a bit. Try pausing the demo (Space) to freeze the final weights.":"Iâ€™ll show the polynomial boundary once the model has trained a bit. Try pausing the demo (Space).";if(s==="mlp")return"The MLP doesnâ€™t have a simple closed-form equation. Itâ€™s a composition of learned nonlinear layers. I can summarize its architecture or last loss if youâ€™d like.";if(s==="knn")return"KNN has no equationâ€”it classifies by the labels of the nearest neighbors in the dataset."}catch(o){x()&&console.debug("agentpanel: status probe error",o)}}if(e.includes("what")&&e.includes("classifier"))return j(s);if(e.includes("advantage")||e.includes("advantages")||e.includes("pro")||e.includes("pros")||e.includes("disadvantage")||e.includes("disadvantages")||e.includes("con")||e.includes("cons")||e.includes("tradeoff")||e.includes("trade-offs")||e.includes("limitations")){const d=["linear","poly","mlp","knn"].find(p=>e.includes(p)||p==="linear"&&e.includes("perceptron")||p==="poly"&&e.includes("polynomial")||p==="mlp"&&e.includes("neural")||p==="knn"&&e.includes("nearest"));return j(d||s)}if(e.includes("explain")||e.includes("what is")){if(e.includes("linear")||e.includes("perceptron"))return"The Linear Perceptron is the simplest form of a neural network. It tries to find a straight line that best separates your data points. Think of it as drawing a line to divide red points from blue points. It's great for data that's already somewhat separated, but struggles with complex patterns.";if(e.includes("polynomial")||e.includes("poly"))return"The Polynomial Perceptron extends the linear version by adding curved features. Instead of just a straight line, it can create curved decision boundaries. This helps when your data forms curved patterns that a straight line can't separate well.";if(e.includes("mlp")||e.includes("neural")||e.includes("network"))return"The Multi-Layer Perceptron (MLP) is a modern neural network with multiple layers of neurons. It can learn very complex patterns and is the foundation of deep learning. You can adjust the number of hidden layers and neurons to control its complexity.";if(e.includes("knn")||e.includes("nearest"))return"The K-Nearest Neighbors (KNN) algorithm is different - it doesn't 'learn' in the traditional sense. When you want to classify a new point, it looks at the K closest points in your training data and votes on the most common class. It's simple but effective for understanding distance-based classification."}if(e.includes("speed")||e.includes("slow")||e.includes("fast"))return`Current speed is ${h}x. You can adjust this using the speed slider in the bottom-left. Higher speeds make animations faster but might be harder to follow. Try 0.5x for detailed observation or 2x for quick demonstrations.`;if(e.includes("compare"))return`Compare mode lets you see two classifiers side-by-side. ${c?"It's currently enabled":"It's currently disabled"}. When enabled, you'll see both algorithms working simultaneously on the same data. This is great for understanding the differences between classifiers!`;if(e.includes("data")||e.includes("points")||e.includes("add"))return"To add data points: **Left-click** for Class A (red points) or **Right-click** for Class B (blue points). On touch devices, use the 'Touch tap adds' control. Try to create interesting patterns - some classifiers work better with certain data distributions!";if(e.includes("tip")||e.includes("help")||e.includes("how")){const o=["Try the Linear Perceptron first - it's the simplest to understand","For curved patterns, switch to Polynomial Perceptron","Use Compare mode to see how different algorithms perform on the same data","KNN works well with small, well-clustered datasets","The MLP can learn very complex patterns but might be slower","Experiment with different data patterns to see how each algorithm responds"];return"ðŸ’¡ **Tip:** "+o[Math.floor(Math.random()*o.length)]}return e.includes("status")||e.includes("current")||e.includes("state")?`**Current Status:**
â€¢ Classifier: ${s.toUpperCase()}
â€¢ Compare Mode: ${c?"Enabled":"Disabled"}
â€¢ Speed: ${h}x
â€¢ Theme: (custom)

Ready to explore machine learning!`:e.includes("hello")||e.includes("hi")||e.includes("hey")?"Hello! I'm here to help you learn about machine learning algorithms. Ask me about classifiers, get tips, or ask for explanations!":e.includes("thank")?"You're welcome! Happy learning! ðŸŽ“":`I can help you with:
â€¢ Explaining different classifiers (Linear, Polynomial, MLP, KNN)
â€¢ Tips for using the visualizer
â€¢ Understanding current settings
â€¢ Guidance on adding data points

Try asking 'explain linear perceptron' or 'give me a tip'!`},S=async n=>{try{const e=await fetch("/api/questions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:n,classifier:s,compareMode:c,speedScale:h,sessionId:_})});if(!e.ok)throw new Error(`HTTP ${e.status}`);const o=await e.json();x()&&console.debug("Question saved:",o)}catch(e){x()&&console.debug("Failed to save question to database:",e)}},N=()=>{if(!a.trim())return;const n={id:r.length+1,text:a,isUser:!0,timestamp:new Date};S(a).catch(d=>{x()&&console.debug("agentpanel: failed to save question",d)});let e;try{t.current&&(e=X(t.current,a,3).map(p=>({...p})))}catch(d){e=void 0,x()&&console.debug("agentpanel: queryIndex error",d)}const o={id:r.length+2,text:M(a),isUser:!1,timestamp:new Date,sources:e};if(w&&e&&e.length){const d=["Retrieved context (top results):"];for(const p of e)d.push(`- ${p.source} (${p.id}) â€” ${(p.text||"").slice(0,180).replace(/\n/g," ")}${(p.text||"").length>180?"â€¦":""}`);o.text=`${d.join(`
`)}

${o.text}`}m(d=>[...d,n,o]),y("")},$=n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),N())};return b?i.jsxs("div",{className:`${u.agentSidebar} ${b?u.open:""}`,children:[i.jsxs("div",{className:u.agentHeader,children:[i.jsx("h3",{children:"ML Assistant"}),i.jsx("button",{onClick:g,className:u.closeButton,title:"Close Assistant",children:"âœ•"})]}),i.jsx("div",{className:u.agentContent,children:i.jsxs("div",{className:u.chatContainer,children:[i.jsx("div",{className:u.messages,children:r.map(n=>i.jsxs("div",{className:`${u.message} ${n.isUser?u.userMessage:u.botMessage}`,children:[i.jsx("div",{className:u.messageText,children:n.text.split(`
`).map((e,o)=>i.jsx("div",{children:e},o))}),i.jsx("div",{className:u.messageTime,children:n.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},n.id))}),i.jsxs("div",{className:u.inputContainer,children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[i.jsxs("label",{style:{fontSize:11,display:"flex",alignItems:"center",gap:5,cursor:"pointer"},children:[i.jsx("input",{type:"checkbox",checked:w,onChange:n=>C(n.target.checked)}),i.jsx("span",{children:"Include retrieved context"})]}),i.jsxs("span",{style:{fontSize:10,opacity:.7},children:["(",f?"index ready":"unavailable",")"]})]}),i.jsxs("div",{style:{display:"flex",gap:10},children:[i.jsx("input",{type:"text",value:a,onChange:n=>y(n.target.value),onKeyPress:$,placeholder:"Ask me about ML, classifiers...",className:u.chatInput}),i.jsx("button",{onClick:N,className:u.sendButton,children:"Send"})]})]})]})})]}):null};export{te as default};
